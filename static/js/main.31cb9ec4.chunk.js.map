{"version":3,"sources":["ui/TitleBar.tsx","util/LruCache.ts","util/modulo.ts","util/shuffleList.ts","api/ContentData.ts","api/SlideManager.ts","util/isMobile.ts","ui/MenuCollapser.tsx","ui/ControlBar.tsx","ui/hooks/useWindowSize.ts","ui/hooks/WindowSizeWrapper.tsx","ui/SliderSlide.tsx","ui/Slider.tsx","api/ContentZoomPan.tsx","ui/ContentRenderer.tsx","ui/AppStyle.js","ui/App.tsx","serviceWorker.js","index.js","api/DisplayStyle.ts","api/Settings.ts","api/TransitionStyle.ts","util/Size.ts","api/ContentType.ts","util/buildArray.ts","util/isElectron.ts","api/FileContentSource.ts","ui/SlideShowMain.tsx","util/listFileEntries.ts","util/promiseAny.ts","util/arrayUnique.ts","api/SlideshowState.ts","api/SlideshowTimer.ts","api/UrlContentSource.ts","ui/DragAndDrop.tsx"],"names":["withStyles","palette","spacing","createStyles","titlebar","display","alignItems","userSelect","backgroundColor","controlPanel","main","justifyContent","position","dragRegion","top","left","width","height","zIndex","appRegion","section","logo","padding","button","borderRadius","closeButton","error","classes","className","slideTitle","classnames","src","process","alt","variant","onClick","global","electronIpc","minimize","maximize","close","LruCache","max","onEviction","cache","this","Map","key","item","get","delete","set","val","has","size","evictOldest","evictKey","first","evictValue","keys","next","value","modulo","a","n","shuffleList","array","i","length","j","Math","floor","random","createImage","url","Promise","res","rej","image","Image","onload","onerror","undefined","createVideo","video","document","createElement","onloadeddata","ContentData","contentSource","objectUrl","type","duration","Size","state","onLoaded","handleLoaded","forEach","callOnLoad","onLoad","getUrl","getObjectUrl","URL","revokeObjectURL","push","doLoad","index","indexOf","splice","cleanup","ContentType","naturalWidth","naturalHeight","Video","videoWidth","videoHeight","SlideManager","sources","startAtSid","cacheSize","startAtIndex","playlist","indexOffset","buildArray","findIndex","s","id","cd","externalIndex","intplIndex","externalToPlaylistIndex","source","data","clear","rating","pow","currentFileIndex","ratings","map","f","maxRating","reduce","p","c","numSeqs","ratePow","instances","Array","fill","count","numWanted","min","target","cur","allSections","unshift","sourceIndex","newPlaylist","plIndex","isMobile","test","navigator","userAgent","MenuCollapser","buttonContent","buttonProps","collapse","children","menuProps","React","useState","anchor","setAnchor","IconButton","e","currentTarget","anchorEl","keepMounted","open","onClose","Children","child","Fragment","SIZE_THRESHOLDS","displayStyleIconRenderers","DisplayStyle","Standard","Stretch","ZoomPan","ZoomPanReturn","Badge","badgeContent","displayStyleSequence","transitionStyleIcons","TransitionStyle","Fade","BlurOnIcon","Slide","SwapHorizIcon","Instant","FlashOnIcon","transitionStyleSequence","root","flex","largeIcon","fontSize","sideContainer","subContainer","centreNavControls","flexBasis","speedContainer","speedSlider","menuPaper","screenWidth","onNext","onPlay","onPause","onBack","onEnterFullscreen","onExitFullscreen","onShuffleChange","onDisplayStyleChange","onSpeedChange","onTransitionStyleChange","onVolumeChange","onFilesAdded","onUrlsAdded","linkInputOpen","setLinkInputOpen","linkUrls","setLinkUrls","tmpInput","dirPropName","find","renderDisplayStyleIcon","displayStyle","TransitionStyleIcon","transitionStyle","anchorOrigin","vertical","horizontal","paper","transformOrigin","component","title","hidden","multiple","onChange","ev","from","files","Dialog","DialogTitle","DialogContent","DialogContentText","TextField","autoFocus","fullWidth","label","margin","split","placeholder","multiline","join","DialogActions","Button","color","isShuffled","isPlaying","Slider","speed","v","Number","step","volume","isFullscreen","useWindowSize","setSize","useLayoutEffect","updateSize","window","innerWidth","innerHeight","addEventListener","removeEventListener","WindowSizeWrapper","SliderSlide","slideState","slideContentRenderer","slide","setSlide","useEffect","overflow","slider","slideFadeTransition","transition","slideSlideTransition","slideInstantTransition","slideIndex","preloadCount","panSensitivity","flickSensitivity","swipePanX","setSwipePanX","rootRef","useRef","ref","onPan","current","panPerc","deltaX","clientWidth","isFinal","velocityX","slideNum","offset","translate","opacity","abs","sign","style","transform","isActive","PlanPoint","x","y","z","d","widerRatioPaths","tallerRatioPaths","similarRatioPaths","contentRatio","xOffset","yOffset","randomItem","items","ContentZoomPan","contentSize","screenSize","onTransform","doubleLoop","timer","plan","transitionMs","scaleMult","nextPoint","clearTimeout","currPoint","fullDuration","pointToTransform","setTimeout","reverse","start","cRat","ratio","sRat","args","screenRatio","slice","totalPause","pp","content","objectFit","pointerEvents","contentStretch","contentZoomPan","onSourceInvalid","dataUrl","setDataUrl","setError","setTransform","err","console","warn","name","load","cancelLoad","getSize","contentType","getType","displaySize","clientHeight","isZoomPan","includes","zoomer","stop","imgVidClassName","autoPlay","loop","muted","preload","vid","paused","play","pause","useStyles","makeStyles","theme","body","AppStyle","CssBaseline","App","themeType","createMuiTheme","primary","teal","background","default","controlPanelOverlay","createTheme","Boolean","location","hostname","match","ReactDOM","render","StrictMode","getElementById","serviceWorker","ready","then","registration","unregister","catch","message","SettingType","SettingSection","settingsKey","reverseSections","Object","entries","k","Settings","controlBar","reversePrefs","getKeys","pref","prefKey","Error","JSON","stringify","sectKey","fullKey","getSetting","isElectron","getSettings","parse","localStorage","getItem","setSetting","settings","setSettings","setItem","_","FileContentSource","file","createObjectURL","getFileEntryContentSource","fileEntry","getFileContentSource","SlideshowMain","props","showControlsTimeout","slideshowTimer","enterFullscreen","requestFullscreen","showControls","exitFullscreen","fullscreenElement","handlePause","updateSsState","handlePlay","handleShuffleChange","shuffle","ssController","getDataForIndex","PreloadCount","unshuffle","setSlideIndex","handleSpeedChange","setSpeed","handlePlainSssChange","constrolsHideable","handleShowControlsTimeout","setState","handleFullscreenChange","handleDrop","fileItems","filter","kind","listFileEntries","webkitGetAsEntry","promiseAny","values","reasons","r","addNewSources","handleFilesAdded","handleUrlsAdded","urls","getUrlContentSource","handleKeyUp","ssState","handled","handlePrevious","handleNext","isBorderless","openDevTools","preventDefault","stopPropagation","renderSlideContent","slideDuration","removeSource","SlideshowTimer","createRef","newSsState","saveSlideshowStateToSettings","newSources","arrayUnique","newSsc","getData","setIndex","slideshow","hideMouse","onMouseMove","onMouseDown","titlebarHideable","titlebarHideableShow","mainArea","onDoubleClick","dragDrop","onDrop","controls","controlsHideable","controlsHideableShow","Component","transitionProperty","transitionDuration","bottom","flexFlow","flexGrow","flexShrink","cursor","fileEntries","all","isFile","isDirectory","createReader","readEntries","flat","promises","allSettled","results","status","reason","arr","keyFunc","result","SpeedDelay","timeout","startedAt","handleDataLoaded","updateTimer","Date","isLoaded","stdDuration","vidDuration","getDuration","delay","calculateRemainingDuration","UrlContentSource","DragAndDrop","dropRef","dragCounter","dragging","handleDrag","handleDragIn","dataTransfer","handleDragOut","div","overlay","overlayMessage","border","right","textAlign"],"mappings":"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","file":"static/js/main.31cb9ec4.chunk.js","sourcesContent":["import React from 'react';\nimport classnames from 'classnames';\n\nimport { createStyles, withStyles, WithStyles, Theme } from '@material-ui/core/styles';\nimport IconButton from '@material-ui/core/IconButton';\nimport Typography from '@material-ui/core/Typography';\nimport CloseIcon from '@material-ui/icons/Close';\nimport MaximizeIcon from '@material-ui/icons/Maximize';\nimport MinimizeIcon from '@material-ui/icons/Minimize';\n\n\nconst styles = ({ palette, spacing }: Theme) => createStyles({\n  titlebar: {\n    display: 'flex',\n    alignItems: 'center',\n    userSelect: 'none',\n    backgroundColor: palette.controlPanel.main,\n    justifyContent: 'space-between',\n    position: 'relative',\n  },\n  dragRegion: {\n    top: 6,\n    left: 6,\n    display: 'block',\n    position: 'absolute',\n    width: 'calc(100% - 12px)',\n    height: 'calc(100% - 6px)',\n    zIndex: -1,\n    appRegion: 'drag',\n  },\n  section: {\n    display: 'flex',\n    height: '100%',\n  },\n  logo: {\n    height: '100%',\n    padding: spacing(0.5),\n  },\n  button: {\n    borderRadius: 0,\n    appRegion: 'no-drag',\n  },\n  closeButton: {\n    '&:hover': {\n      backgroundColor: palette.error.main,\n    },\n  },\n});\n\ninterface Props extends WithStyles<typeof styles> {\n  className?: string;\n  slideTitle?: string;\n}\nconst TitleBar: React.FC<Props> = ({\n  classes,\n  className,\n  slideTitle,\n}) => (\n  <div className={classnames(className, classes.titlebar)}>\n    <div className={classes.dragRegion}></div>\n    <div className={classes.section}>\n      <img className={classes.logo} src={`${process.env.PUBLIC_URL}/logo192.png`} alt=\"\" />\n      <Typography display=\"inline\" variant=\"subtitle1\">Slideshow</Typography>\n    </div>\n    <div className={classes.section}>\n      <Typography display=\"inline\" variant=\"subtitle1\">{slideTitle}</Typography>\n    </div>\n    <div className={classes.section}>\n      <IconButton\n        className={classes.button}\n        onClick={() => global.electronIpc?.minimize()}\n      >\n        <MinimizeIcon />\n      </IconButton>\n      <IconButton\n        className={classes.button}\n        onClick={() => global.electronIpc?.maximize()}\n      >\n        <MaximizeIcon />\n      </IconButton>\n      <IconButton\n        className={classnames(classes.button, classes.closeButton)}\n        onClick={() => global.electronIpc?.close()}\n      >\n        <CloseIcon />\n      </IconButton>\n    </div>\n  </div>\n);\n\nexport default withStyles(styles)(TitleBar);\n","\ntype OnEviction<K, V> = (key: K, val: V) => void;\ninterface Options<K, V> {\n  max?: number;\n  onEviction?: OnEviction<K, V>;\n}\nclass LruCache<K, V> {\n  readonly max: number;\n  readonly cache: Map<K, V>;\n  readonly onEviction: OnEviction<K, V>;\n\n  constructor({ max = 10, onEviction = () => {} }: Options<K, V> = {}) {\n      this.max = max;\n      this.cache = new Map();\n      this.onEviction = onEviction;\n  }\n\n  get(key: K) {\n    let item = this.cache.get(key);\n    if (item) {\n      // refresh key\n      this.cache.delete(key);\n      this.cache.set(key, item);\n    }\n    return item;\n  }\n\n  set(key: K, val: V) {\n    if (this.cache.has(key)) {\n      // refresh key\n      this.cache.delete(key);\n    } else if (this.cache.size === this.max) {\n      this.evictOldest();\n    }\n    this.cache.set(key, val);\n  }\n\n  clear() {\n    while (this.cache.size > 0) {\n      this.evictOldest();\n    }\n  }\n\n  private evictOldest() {\n    const evictKey = this.first();\n    const evictValue = this.cache.get(evictKey) as V;\n    this.cache.delete(this.first());\n    this.onEviction(evictKey, evictValue);\n  }\n\n  private first() {\n    return this.cache.keys().next().value;\n  }\n}\n\nexport default LruCache;\n","const modulo = (a: number, n: number): number => ((a % n) + n) % n;\n\nexport default modulo;\n","const shuffleList = (array: any[]) => {\n  for (let i = array.length - 1; i > 0; i -= 1) {\n    const j = Math.floor(Math.random() * (i + 1));\n    // eslint-disable-next-line no-param-reassign\n    [array[i], array[j]] = [array[j], array[i]];\n  }\n};\n\nexport default shuffleList;\n","import Size from '../util/Size';\nimport ContentSource from './ContentSource';\nimport ContentType from './ContentType';\n\nconst createImage = async (url: string) => new Promise<HTMLImageElement | undefined>((res, rej) => {\n  const image = new Image();\n  image.onload = () => res(image);\n  image.onerror = () => res(undefined);\n  image.src = url;\n});\n\nconst createVideo = async (url: string) => new Promise<HTMLVideoElement | undefined>((res, rej) => {\n  var video = document.createElement(\"video\");\n  video.onloadeddata = () => res(video);\n  video.onerror = () => res(undefined);\n  video.src = url;\n});\n\ntype OnContentDataLoaded = (err: string | undefined, url: string | undefined) => void;\n\nclass ContentData {\n  readonly contentSource: ContentSource;\n  private objectUrl: string | undefined;\n  private type: ContentType | undefined;\n  private duration: number = 0;\n  private size: Size = new Size(0, 0);\n  private state: 'new' | 'loading' | 'loaded' = 'new';\n  private onLoaded: OnContentDataLoaded[] = [];\n  \n\n  constructor(contentSource: ContentSource) {\n    this.contentSource = contentSource;\n  }\n\n  getType() {\n    return this.type;\n  }\n  \n  private getUrl() {\n    if (!this.objectUrl) {\n      this.objectUrl = this.contentSource.getObjectUrl();\n    }\n    return this.objectUrl;\n  }\n\n  cleanup() {\n    if (this.objectUrl) {\n      URL.revokeObjectURL(this.objectUrl);\n    }\n    this.objectUrl = undefined;\n  }\n\n  getDuration() {\n    return this.duration;\n  }\n\n  getSize() {\n    return this.size;\n  }\n\n  isLoaded() {\n    return this.state === 'loaded';\n  }\n\n  load(onLoad: OnContentDataLoaded) {\n    if (this.state === 'loaded') {\n      this.callOnLoad(onLoad);\n    } else {\n      this.onLoaded.push(onLoad);\n      if (this.state === 'new') {\n        this.doLoad();\n      }\n    }\n  }\n\n  cancelLoad(onLoad: OnContentDataLoaded) {\n    const index = this.onLoaded.indexOf(onLoad);\n    if (index >= 0) {\n      this.onLoaded.splice(index, 1);\n    }\n    if (!this.onLoaded.length) {\n      this.cleanup();\n    }\n  }\n\n  private async doLoad() {\n    if (this.state !== 'new') return;\n    this.state = 'loading';\n    const image = await createImage(this.getUrl());\n    if (image) {\n      this.type = ContentType.Image;\n      this.size = new Size(image.naturalWidth, image.naturalHeight);\n    } else {\n      const video = await createVideo(this.getUrl());\n      if (video) {\n        this.duration = video.duration;\n        this.type = ContentType.Video;\n        this.size = new Size(video.videoWidth, video.videoHeight);\n      }\n    }\n    this.handleLoaded();\n  }\n\n  private handleLoaded = () => {\n    this.state = 'loaded';\n    this.onLoaded.forEach(this.callOnLoad);\n  };\n  \n  private callOnLoad = (onLoad: OnContentDataLoaded) => {\n    if (this.type) {\n      onLoad(undefined, this.getUrl());\n    } else {\n      onLoad('Was not a supported image or video', undefined);\n    }\n  }\n\n}\n\nexport default ContentData;\n","import buildArray from '../util/buildArray';\nimport LruCache from '../util/LruCache';\nimport modulo from '../util/modulo';\nimport shuffleList from '../util/shuffleList';\nimport ContentData from './ContentData';\nimport ContentSource from './ContentSource';\n\ninterface StartAt {\n  startAtSid?: string;\n  startAtIndex?: number;\n}\ninterface Options extends StartAt {\n  cacheSize?: number;\n}\n\nclass SlideManager {\n  readonly sources: ContentSource[] = [];\n  private playlist: number[] = [];\n  private cache: LruCache<string, ContentData>;\n\n  private indexOffset: number = 0;\n\n  constructor(sources: ContentSource[], { startAtSid, cacheSize = 10, startAtIndex = 0 }: Options = {}) {\n    this.sources = sources;\n    this.playlist = buildArray(sources.length, i => i);\n    this.indexOffset = Math.max(0, sources.findIndex(s => s.id === startAtSid)) - startAtIndex;\n    this.cache = new LruCache({ max: cacheSize, onEviction: (id, cd) => cd.cleanup() });\n  }\n\n  private externalToPlaylistIndex(externalIndex: number) {\n    return modulo(externalIndex + this.indexOffset, this.playlist.length)\n  }\n\n  getDataForIndex(index: number) {\n    const intplIndex = this.externalToPlaylistIndex(index);\n    const source = this.sources[this.playlist[intplIndex]];\n    let data = this.cache.get(source.id);\n    if (data) {\n      return data;\n    }\n    data = new ContentData(source);\n    this.cache.set(source.id, data);\n    return data;\n  }\n\n  cleanup() {\n    this.cache.clear();\n  }\n\n  private ratePow(rating: number) {\n    if (rating === 0) {\n      return 0;\n    }\n    return Math.pow(2, rating - 1);\n  }\n\n  shuffle({ startAtIndex = 0, startAtSid }: StartAt) {\n    const currentFileIndex = this.sources.findIndex(s => s.id === startAtSid);\n    const ratings = this.sources.map(f => 3 /*f.GetMetaData().rating*/);\n    const maxRating = ratings.reduce((p, c) => Math.max(p, c))  ;\n    const numSeqs = this.ratePow(maxRating);\n    const instances = buildArray(this.sources.length, () => Array(numSeqs).fill(false));\n    for (let i = 0; i < this.sources.length; i++) {\n      let count = 0;\n      const numWanted = Math.min(numSeqs, this.ratePow(ratings[i]));\n      while (count < numWanted) {\n        const target = Math.floor(Math.random() * (numSeqs - count));\n        let cur = -1;\n        let j = -1;\n        while (cur < target) {\n          j++;\n          if (!instances[i][j]) {\n            cur++;\n          }\n        }\n        instances[i][j] = true;\n        count++;\n      }\n    }\n\n    if (currentFileIndex >= 0) {\n      // Prevent the current slide from showing up in the first section, since\n      // it's already showing and we'll add it to the front of the list soon.\n      instances[currentFileIndex][0] = false;\n    }\n\n    const allSections: number[] = [];\n    let section: number[];\n    for (let i = 0; i < numSeqs; i++) {\n      section = [];\n      for (let j = 0; j < this.sources.length; j++) {\n        if (instances[j][i]) {\n            section.push(j);\n        }\n      }\n      shuffleList(section);\n      allSections.push(...section);\n    }\n    this.playlist = allSections;\n    if (currentFileIndex >= 0) {\n      this.playlist.unshift(currentFileIndex);\n    }\n    this.indexOffset = -startAtIndex;\n  }\n\n  unshuffle({ startAtIndex = 0, startAtSid }: StartAt) {\n    this.indexOffset = Math.max(0, this.sources.findIndex(s => s.id === startAtSid)) - startAtIndex;\n    this.playlist = buildArray(this.sources.length, i => i);\n  }\n\n  removeSource(source: ContentSource) {\n    const sourceIndex = this.sources.findIndex((s) => s.id === source.id);\n    if (sourceIndex < 0) return;\n    this.sources.splice(sourceIndex, 1);\n    const newPlaylist: number[] = [];\n    this.playlist.forEach((plIndex) => {\n      if (plIndex < sourceIndex) {\n        newPlaylist.push(plIndex);\n      } else if (plIndex > sourceIndex) {\n        newPlaylist.push(plIndex - 1);\n      }\n    });\n    this.playlist = newPlaylist;\n  }\n}\n\nexport default SlideManager;\n","\nconst isMobile = (): boolean => /Mobi|Android/i.test(navigator.userAgent);\n\nexport default isMobile;\n","import React from 'react';\nimport IconButton, { IconButtonProps } from '@material-ui/core/IconButton';\nimport Menu, { MenuProps } from '@material-ui/core/Menu';\n\ninterface Props {\n  buttonContent: React.ReactNode;\n  buttonProps?: Partial<IconButtonProps>;\n  children: React.ReactNode;\n  collapse?: boolean;\n  menuProps?: Partial<MenuProps>;\n}\nconst MenuCollapser: React.FC<Props> = ({\n  buttonContent,\n  buttonProps = {},\n  collapse = false,\n  children,\n  menuProps = {},\n}) => {\n  const [anchor, setAnchor] = React.useState<null | HTMLElement>(null);\n  if (!collapse) {\n    return <React.Fragment>{children}</React.Fragment>;\n  }\n  return (\n    <div>\n      <IconButton\n        onClick={e => setAnchor(anchor ? null : e.currentTarget)}\n        {...buttonProps}\n      >\n        {buttonContent}\n      </IconButton>\n      <Menu\n        anchorEl={anchor}\n        keepMounted\n        open={!!anchor}\n        onClose={() => setAnchor(null)}\n        {...menuProps}\n      >\n        {React.Children.map(children, child => <li>{child}</li>)}\n      </Menu>\n    </div>\n  );\n};\n\nexport default MenuCollapser;\n","import React from 'react';\nimport classnames from 'classnames';\n\nimport { createStyles, withStyles, WithStyles, Theme } from '@material-ui/core/styles';\nimport Badge from '@material-ui/core/Badge';\nimport Button from '@material-ui/core/Button';\nimport Dialog from '@material-ui/core/Dialog';\nimport DialogActions from '@material-ui/core/DialogActions';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport DialogContentText from '@material-ui/core/DialogContentText';\nimport DialogTitle from '@material-ui/core/DialogTitle';\nimport IconButton from '@material-ui/core/IconButton';\nimport Slider from '@material-ui/core/Slider';\nimport TextField from '@material-ui/core/TextField';\n\nimport AddIcon from '@material-ui/icons/Add';\nimport ArrowRightAltIcon from '@material-ui/icons/ArrowRightAlt';\nimport BlurOnIcon from '@material-ui/icons/BlurOn';\nimport ControlCameraIcon from '@material-ui/icons/ControlCamera';\nimport CropOriginalIcon from '@material-ui/icons/CropOriginal';\nimport PasteIcon from '@material-ui/icons/Assignment';\nimport FlashOnIcon from '@material-ui/icons/FlashOn';\nimport FolderOpenIcon from '@material-ui/icons/FolderOpen';\nimport FullscreenIcon from '@material-ui/icons/Fullscreen';\nimport FullscreenExitIcon from '@material-ui/icons/FullscreenExit';\nimport HeightIcon from '@material-ui/icons/Height';\nimport ImageIcon from '@material-ui/icons/Image';\nimport LinkIcon from '@material-ui/icons/Link';\nimport MenuIcon from '@material-ui/icons/Menu';\nimport MoreVertIcon from '@material-ui/icons/MoreVert';\nimport NavigateNextIcon from '@material-ui/icons/NavigateNext';\nimport NavigateBeforeIcon from '@material-ui/icons/NavigateBefore';\nimport PlayArrowIcon from '@material-ui/icons/PlayArrow';\nimport PauseIcon from '@material-ui/icons/Pause';\nimport ShuffleIcon from '@material-ui/icons/Shuffle';\nimport SwapHorizIcon from '@material-ui/icons/SwapHoriz';\nimport VolumeMuteIcon from '@material-ui/icons/VolumeMute';\n\nimport SlideshowState from '../api/SlideshowState';\nimport isMobile from '../util/isMobile';\nimport MenuCollapser from './MenuCollapser';\nimport TransitionStyle from '../api/TransitionStyle';\nimport DisplayStyle from '../api/DisplayStyle';\n\nconst SIZE_THRESHOLDS = [800, 600];\n\nconst styles = ({ palette, spacing }: Theme) => createStyles({\n  root: {\n    backgroundColor: palette.controlPanel.main,\n    display: 'flex',\n    justifyContent: 'space-evenly',\n    alignItems: 'center',\n    '&>*': {\n      flex: '1 1 0',\n    },\n  },\n  largeIcon: {\n    fontSize: '3rem'\n  },\n  sideContainer: {\n    display: 'flex',\n    justifyContent: 'space-between',\n    alignItems: 'center',\n    width: 'auto',\n  },\n  subContainer: {\n    display: 'flex',\n    justifyContent: 'center',\n    alignItems: 'center',\n  },\n  centreNavControls: {\n    display: 'flex',\n    justifyContent: 'center',\n    flexBasis: 'auto',\n    flex: '0 0',\n    alignItems: 'center',\n  },\n  speedContainer: {\n    display: 'flex', // For some reason needed to properly size itself!?!?\n  },\n  speedSlider: {\n    width: 100,\n  },\n  menuPaper: {\n    backgroundColor: 'rgba(0, 0, 0, 0.75)',\n  },\n});\n\nconst displayStyleIconRenderers = {\n  [DisplayStyle.Standard]: () => <CropOriginalIcon />,\n  [DisplayStyle.Stretch]: () => <HeightIcon />,\n  [DisplayStyle.ZoomPan]: () => <ControlCameraIcon />,\n  [DisplayStyle.ZoomPanReturn]: () => <Badge badgeContent={'2'}><ControlCameraIcon /></Badge>,\n};\n\nconst displayStyleSequence = {\n  [DisplayStyle.Standard]: DisplayStyle.Stretch,\n  [DisplayStyle.Stretch]: DisplayStyle.ZoomPan,\n  [DisplayStyle.ZoomPan]: DisplayStyle.ZoomPanReturn,\n  [DisplayStyle.ZoomPanReturn]: DisplayStyle.Standard,\n};\n\nconst transitionStyleIcons = {\n  [TransitionStyle.Fade]: BlurOnIcon,\n  [TransitionStyle.Slide]: SwapHorizIcon,\n  [TransitionStyle.Instant]: FlashOnIcon,\n};\n\nconst transitionStyleSequence = {\n  [TransitionStyle.Fade]: TransitionStyle.Slide,\n  [TransitionStyle.Slide]: TransitionStyle.Instant,\n  [TransitionStyle.Instant]: TransitionStyle.Fade,\n};\n\ninterface Props extends WithStyles<typeof styles> {\n  className?: string;\n  screenWidth?: number;\n  state: SlideshowState;\n  onNext?: () => void;\n  onPlay?: () => void;\n  onPause?: () => void;\n  onBack?: () => void;\n  onEnterFullscreen?: () => void;\n  onExitFullscreen?: () => void;\n  onDisplayStyleChange?: (style: DisplayStyle) => void;\n  onShuffleChange?: (shuffle: boolean) => void;\n  onSpeedChange?: (speed: number) => void;\n  onTransitionStyleChange?: (style: TransitionStyle) => void;\n  onVolumeChange?: (volume: number) => void;\n  onFilesAdded?: (files: File[]) => void;\n  onUrlsAdded?: (files: string[]) => void;\n}\nconst ControlBar: React.FC<Props> = ({\n  classes, className, screenWidth = 0, state,\n  onNext = () => {},\n  onPlay = () => {},\n  onPause = () => {},\n  onBack = () => {},\n  onEnterFullscreen = () => {},\n  onExitFullscreen = () => {},\n  onShuffleChange = () => {},\n  onDisplayStyleChange = () => {},\n  onSpeedChange = () => {},\n  onTransitionStyleChange = () => {},\n  onVolumeChange = () => {},\n  onFilesAdded = () => {},\n  onUrlsAdded = () => {},\n}) => {\n  const [linkInputOpen, setLinkInputOpen] = React.useState(false);\n  const [linkUrls, setLinkUrls] = React.useState<string[]>([]);\n  const tmpInput = document.createElement('input');\n  const dirPropName = ['webkitdirectory', 'mozdirectory', 'odirectory', 'msdirectory', 'directory'].find(p => p in tmpInput);\n  const size = screenWidth && SIZE_THRESHOLDS.reduce((p, c, i) => screenWidth <= c ? i : p, -1);\n  const renderDisplayStyleIcon = displayStyleIconRenderers[state.displayStyle];\n  const TransitionStyleIcon = transitionStyleIcons[state.transitionStyle];\n  return (\n    <div className={classnames(classes.root, className)}>\n      <div className={classes.sideContainer}>\n        <div className={classes.subContainer}>\n          <IconButton><MenuIcon /></IconButton>\n          <MenuCollapser\n            buttonContent={<Badge badgeContent={'^'}><AddIcon /></Badge>}\n            collapse={size >= 0}\n            menuProps={{\n              anchorOrigin: {\n                vertical: 'top',\n                horizontal: 'center',\n              },\n              classes: { paper: classes.menuPaper },\n              transformOrigin: {\n                vertical: 'bottom',\n                horizontal: 'center',\n              },\n            }}\n          >\n            {!isMobile() && (\n              // Disable folder selection of mobiles for now, since it's VERY\n              // iffy (i.e. I can't get it working at all...)\n              <IconButton component=\"label\" title=\"Add folders...\">\n                <input\n                  type=\"file\"\n                  hidden\n                  multiple\n                    onChange={ev => onFilesAdded(Array.from(ev.target.files as ArrayLike<File>))}\n                  // NOTE: Firefox Android requires the dom.webkitBlink.dirPicker.enabled\n                  // option to be set to true in about:config to allow picking of directories\n                  {...{ [dirPropName || 'multiple']: '' }}\n                />\n                <Badge badgeContent={'+'}><FolderOpenIcon /></Badge>\n              </IconButton>\n            )}\n            <IconButton component=\"label\" title=\"Add files...\">\n              <input\n                type=\"file\"\n                hidden\n                multiple\n                  onChange={ev => onFilesAdded(Array.from(ev.target.files as ArrayLike<File>))}\n              />\n              <Badge badgeContent={'+'}><ImageIcon /></Badge>\n            </IconButton>\n            <IconButton\n              component=\"label\"\n              onClick={() => setLinkInputOpen(true)}\n              title=\"Add URLs...\"\n            >\n              <Badge badgeContent={'+'}><LinkIcon /></Badge>\n            </IconButton>\n            <IconButton\n              component=\"label\"\n              onClick={() => undefined} // TODO !!!\n              title=\"Add from clipboard...\"\n            >\n              <Badge badgeContent={'+'}><PasteIcon /></Badge>\n            </IconButton>\n          </MenuCollapser>\n          <Dialog onClose={() => setLinkInputOpen(false)} open={linkInputOpen}>\n            <DialogTitle>Enter URLs to add</DialogTitle>\n            <DialogContent>\n              <DialogContentText>\n                URLs can be for media such as a video or image\n                {/* , or for compilations of media, such as a pastebin with a URL on each line (not yet implemented). */}\n              </DialogContentText>\n              <TextField\n                autoFocus\n                fullWidth\n                id=\"urls\"\n                label=\"URLs\"\n                margin=\"dense\"\n                onChange={e => setLinkUrls(e.target.value.split('\\n'))}\n                placeholder=\"https://example.com\"\n                multiline\n                type=\"url\"\n                value={linkUrls.join('\\n')}\n              />\n            </DialogContent>\n            <DialogActions>\n              <Button onClick={() => {\n                  setLinkInputOpen(false);\n                  setLinkUrls([]);\n                }}\n                color=\"primary\"\n              >\n                Cancel\n              </Button>\n              <Button\n                onClick={() => {\n                  onUrlsAdded(linkUrls);\n                  setLinkUrls([]);\n                  setLinkInputOpen(false);\n                }}\n                color=\"primary\"\n              >\n                Add\n              </Button>\n            </DialogActions>\n          </Dialog>\n        </div>\n        <div className={classes.subContainer}>\n          <MenuCollapser\n            buttonContent={<Badge badgeContent={'^'}><MoreVertIcon /></Badge>}\n            collapse={size >= 1}\n            menuProps={{\n              anchorOrigin: {\n                vertical: 'top',\n                horizontal: 'center',\n              },\n              classes: { paper: classes.menuPaper },\n              transformOrigin: {\n                vertical: 'bottom',\n                horizontal: 'center',\n              },\n            }}\n          >\n          <IconButton\n            onClick={() => onShuffleChange(!state.isShuffled)}\n            title={state.isShuffled ? 'Shuffle: On' : 'Shuffle: Off'}\n          >\n            {state.isShuffled ? <ShuffleIcon /> : <ArrowRightAltIcon />}\n          </IconButton>\n          <IconButton\n            onClick={() => onDisplayStyleChange(displayStyleSequence[state.displayStyle])}\n            title={`Display: ${DisplayStyle[state.displayStyle]}`}\n          >\n            {renderDisplayStyleIcon()}\n          </IconButton>\n            <IconButton\n              onClick={() => onTransitionStyleChange(transitionStyleSequence[state.transitionStyle])}\n              title={`Transition: ${TransitionStyle[state.transitionStyle]}`}\n            >\n              <TransitionStyleIcon />\n            </IconButton>\n          </MenuCollapser>\n        </div>\n        <div />\n      </div>\n      <div className={classes.centreNavControls}>\n        {!isMobile() && <IconButton onClick={onBack}><NavigateBeforeIcon /></IconButton>}\n        <IconButton onClick={() => (state.isPlaying ? onPause(): onPlay())} size=\"small\">\n          {state.isPlaying && <PauseIcon className={classes.largeIcon} />}\n          {!state.isPlaying && <PlayArrowIcon className={classes.largeIcon} />}\n        </IconButton>\n        {!isMobile() && <IconButton onClick={onNext}><NavigateNextIcon /></IconButton>}\n      </div>\n      <div className={classes.sideContainer}>\n        <div />\n        <div className={classes.subContainer}>\n          <Slider\n            className={classes.speedSlider}\n            value={state.speed}\n            max={5}\n            min={1}\n            onChange={(e, v) => { if (state.speed !== v) onSpeedChange(Number(v)); }}\n            step={1}\n          />\n        </div>\n        <div className={classes.subContainer}>\n          <IconButton\n            color={state.volume === 0 ? 'primary' : undefined}\n            onClick={() => onVolumeChange(state.volume === 0 ? 100 : 0 )}\n          >\n            <VolumeMuteIcon />\n          </IconButton>\n          <IconButton onClick={() => (state.isFullscreen ? onExitFullscreen(): onEnterFullscreen())}>\n            {state.isFullscreen ? <FullscreenExitIcon /> : <FullscreenIcon />}\n          </IconButton>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default withStyles(styles)(ControlBar);\n","import { useLayoutEffect, useState } from 'react';\nimport Size from '../../util/Size';\n\nconst useWindowSize = (): Size => {\n  const [size, setSize] = useState(new Size(0, 0));\n  useLayoutEffect(() => {\n    function updateSize() {\n      setSize(new Size(window.innerWidth, window.innerHeight));\n    }\n    window.addEventListener('resize', updateSize);\n    updateSize();\n    return () => window.removeEventListener('resize', updateSize);\n  }, []);\n  return size;\n}\n\nexport default useWindowSize;\n","import { FunctionComponent } from 'react';\nimport Size from '../../util/Size';\nimport useWindowSize from './useWindowSize';\n\ntype WindowSizeChildren = (size: Size) => any;\n\ninterface WindowSizeProps {\n  children: WindowSizeChildren;\n}\n\nconst WindowSizeWrapper: FunctionComponent<WindowSizeProps> = ({ children }) => children(useWindowSize());\n\nexport default WindowSizeWrapper;\n","import React from 'react';\nimport SlideState from '../api/SlideState';\n\ninterface Props {\n  slideState: SlideState;\n  slideContentRenderer: (state: SlideState) => React.ReactNode;\n}\nconst SliderSlide: React.FC<Props> = ({ slideState, slideContentRenderer }) => {\n  const [slide, setSlide] = React.useState<React.ReactNode | undefined>(undefined);\n  React.useEffect(() => setSlide(slideContentRenderer(slideState)), [slideState, slideContentRenderer]); // TODO: Is this doing anything with slideState as dependency?\n  return <React.Fragment>{slide}</React.Fragment>;\n};\n\nexport default SliderSlide;\n","import React from 'react';\nimport Hammer from 'react-hammerjs';\nimport classnames from 'classnames';\n\nimport { createStyles, withStyles, WithStyles, Theme } from '@material-ui/core/styles';\nimport SliderSlide from './SliderSlide';\nimport buildArray from '../util/buildArray';\nimport SlideState from '../api/SlideState';\nimport TransitionStyle from '../api/TransitionStyle';\n\nconst styles = ({ palette, spacing }: Theme) => createStyles({\n  root: {\n    overflow: 'hidden',\n    height: '100%',\n    width: '100%',\n  },\n  slider: {\n    width: '100%',\n    height: '100%',\n    position: 'relative',\n  },\n  slide: {\n    width: '100%',\n    height: '100%',\n    position: 'absolute',\n  },\n  slideFadeTransition: {\n    // TODO: Calculate transition duration based on flock velocity when flick occurs?\n    transition: 'opacity 400ms ease', // cubic-bezier(0.5, 0, 0.5, 1)',\n  },\n  slideSlideTransition: {\n    // TODO: Calculate transition duration based on flock velocity when flick occurs?\n    transition: 'transform 200ms ease-out', // cubic-bezier(0.5, 0, 0.5, 1)`,\n  },\n  slideInstantTransition: {},\n});\n\ninterface Props extends WithStyles<typeof styles> {\n  className?: string;\n  slideIndex: number;\n  slideContentRenderer: (state: SlideState) => React.ReactNode,\n  preloadCount?: number;\n  onNext?: () => void;\n  onBack?: () => void;\n  /** Minimum % pan to trigger slide change */\n  panSensitivity?: number;\n  /** Minimum flick velocity to trigger slide change */\n  flickSensitivity?: number;\n  transitionStyle?: TransitionStyle;\n}\nconst Slider: React.FC<Props> = ({\n  classes, className,\n  slideIndex,\n  slideContentRenderer,\n  preloadCount = 1,\n  onNext = () => {},\n  onBack = () => {},\n  panSensitivity = 25,\n  flickSensitivity = 1.0,\n  transitionStyle = TransitionStyle.Slide,\n}) => {\n  const [swipePanX, setSwipePanX] = React.useState<number>(0);\n  const rootRef = React.useRef<HTMLDivElement>(null);\n\n  const handlePan: HammerListener = (e) => {\n    if (rootRef.current) {\n      const panPerc = 100 * e.deltaX / rootRef.current.clientWidth;\n      setSwipePanX(panPerc);\n      if (e.isFinal) {\n        setSwipePanX(0);\n        if (e.velocityX > flickSensitivity) {\n          onBack();\n        } else if (e.velocityX < -flickSensitivity) {\n          onNext();\n        } else if (panPerc <= -panSensitivity) {\n          onNext();\n        } else if (panPerc >= panSensitivity) {\n          onBack();\n        }\n      }\n    }\n  };\n\n  const renderSlide = (slideNum: number) => {\n    const offset = slideNum - preloadCount;\n    const translate = swipePanX + offset * 100;\n    let opacity = 1;\n    if (transitionStyle === TransitionStyle.Fade) {\n      if (offset === 0) {\n        opacity = 1 - (Math.abs(swipePanX) / 100);\n      } else if (offset * Math.sign(swipePanX) === -1) {\n        // This is the next or previous slide and is fading in\n        opacity = Math.abs(swipePanX) / 100;\n      } else {\n        opacity = 0;\n      }\n    } else if (transitionStyle === TransitionStyle.Instant) {\n      opacity = offset === 0 ? 1 : 0;\n    }\n\n    return (\n      <div\n        className={classnames(classes.slide, {\n          [classes.slideFadeTransition]: !swipePanX && transitionStyle === TransitionStyle.Fade,\n          [classes.slideInstantTransition]: !swipePanX && transitionStyle === TransitionStyle.Instant,\n          [classes.slideSlideTransition]: !swipePanX && transitionStyle === TransitionStyle.Slide,\n        })}\n        key={slideIndex + offset}\n        style={{\n          transform: `translateX(${translate}%)`,\n          opacity,\n          zIndex: opacity === 0 ? 0 : 1,\n        }}\n      >\n        <SliderSlide\n          slideState={{\n            index: slideIndex + offset,\n            isActive: offset === 0 && swipePanX === 0,\n          }}\n          slideContentRenderer={slideContentRenderer}\n        />\n      </div>\n    );\n  };\n\n  return (\n    <div className={classnames(classes.root, className)} ref={rootRef}>\n      <Hammer onPan={handlePan}>\n        <div className={classes.slider}>\n          {buildArray(preloadCount * 2 + 1, renderSlide)}\n        </div>\n      </Hammer>\n    </div>\n  );\n}\n\nexport default withStyles(styles)(Slider);\n","import { CSSProperties } from 'react';\nimport Size from '../util/Size';\n\nclass PlanPoint {\n  readonly x: number;\n  readonly y: number;\n  readonly z: number;\n  readonly d: number;\n\n  constructor(x: number, y: number, z: number, d: number) {\n    this.x = x;\n    this.y = y;\n    this.z = z;\n    this.d = d;\n  }\n}\n\ninterface PathArgs {\n  contentRatio: number;\n  screenRatio: number;\n}\ntype PathCreator = ((args: PathArgs) => PlanPoint[]);\n\nconst widerRatioPaths: PathCreator[] = [\n  () => [\n    new PlanPoint(0.1, 0.5, 0.8, 0.05),\n    new PlanPoint(0.9, 0.5, 0.8, 0.05),\n    new PlanPoint(0.5, 0.5, 0.2, 0.05),\n  ],\n  () => [\n    new PlanPoint(0.9, 0.5, 0.8, 0.05),\n    new PlanPoint(0.1, 0.5, 0.8, 0.05),\n    new PlanPoint(0.5, 0.5, 0.2, 0.05),\n  ],\n];\nconst tallerRatioPaths: PathCreator[] = [\n  () => [\n    new PlanPoint(0.5, 0.1, 0.8, 0.05),\n    new PlanPoint(0.5, 0.9, 0.8, 0.05),\n    new PlanPoint(0.5, 0.5, 0.2, 0.05),\n  ],\n  () => [\n    new PlanPoint(0.5, 0.9, 0.8, 0.05),\n    new PlanPoint(0.5, 0.1, 0.8, 0.05),\n    new PlanPoint(0.5, 0.5, 0.2, 0.05),\n  ],\n];\nconst similarRatioPaths: PathCreator[] = [\n  ({ contentRatio }) => {\n    const xOffset = contentRatio < 1 ? 0 : Math.random() * 0.2 - 0.1;\n    const yOffset = contentRatio > 1 ? 0 : Math.random() * 0.2 - 0.1;\n    return [\n      new PlanPoint(0.5 + xOffset, 0.5 + yOffset, 0.4, 0.05),\n      new PlanPoint(0.5, 0.5, 0.2, 0.05),\n    ];\n  },\n  ({ contentRatio }) => {\n    const xOffset = contentRatio < 1 ? 0 : Math.random() * 0.2 - 0.1;\n    const yOffset = contentRatio > 1 ? 0 : Math.random() * 0.2 - 0.1;\n    return [\n      new PlanPoint(0.5 + xOffset, 0.5 + yOffset, 0.4, 0.05),\n      new PlanPoint(0.5, 0.5, 0.0, 0.05),\n    ];\n  },\n];\n\nconst randomItem = function<T>(items: T[]) {\n  return items[Math.floor(Math.random() * items.length)];\n};\n\nclass ContentZoomPan {\n  contentSize: Size;\n  screenSize: Size;\n  duration: number;\n  timer: number = 0;\n  plan: PlanPoint[] = [];\n  doubleLoop: boolean;\n  transitionMs: number;\n  scaleMult: number = 1;\n  current: number = 0;\n  onTransform: (style: CSSProperties) => void = () => {};\n\n  constructor(\n    contentSize: Size,\n    screenSize: Size,\n    duration: number,\n    onTransform: (style: CSSProperties) => void,\n    doubleLoop = false,\n  ) {\n    this.contentSize = contentSize;\n    this.screenSize = screenSize;\n    this.duration = duration;\n    this.onTransform = onTransform;\n    this.transitionMs = duration;\n    this.doubleLoop = doubleLoop;\n\n    const cRat = contentSize.ratio();\n    const sRat = screenSize.ratio();\n    const args = { contentRatio: cRat, screenRatio: sRat };\n    if (Math.abs(cRat - sRat) > 0.5) {\n      if (cRat > sRat) {\n        this.scaleMult = screenSize.height / (screenSize.width / cRat);\n        this.plan = randomItem(widerRatioPaths)(args);\n      } else {\n        this.scaleMult = screenSize.width / (screenSize.height * cRat);\n        this.plan = randomItem(tallerRatioPaths)(args);\n      }\n    } else {\n      this.scaleMult = 2;\n      this.plan = randomItem(similarRatioPaths)(args);\n    }\n    if (this.plan.length > 1) {\n      if (Math.random() < 0.5) {\n        this.plan.reverse();\n      }\n      if (this.doubleLoop) {\n        this.plan = [...this.plan, ...[...this.plan].reverse().slice(1)];\n      }\n      const totalPause = this.plan.reduce((p, c) => p + (c.d * duration), 0);\n      this.transitionMs = (this.duration - totalPause) / (this.plan.length - 1);\n    }\n  }\n\n  start() {\n    this.current = 0;\n    if (this.plan.length === 0) return;\n    const currPoint = this.plan[this.current];\n    this.onTransform({\n      transform: this.pointToTransform(currPoint),\n      transition: 'none',\n    });\n    this.timer = window.setTimeout(this.nextPoint, currPoint.d * this.duration);\n  }\n\n  stop() {\n    this.onTransform({\n      transform: 'none',\n      transition: 'none',\n    });\n    window.clearTimeout(this.timer);\n  }\n\n  private nextPoint = () => {\n    window.clearTimeout(this.timer);\n    this.current += 1;\n    const currPoint = this.plan[this.current];\n    const fullDuration = this.transitionMs + (currPoint.d * this.duration);\n    this.onTransform({\n      transform: this.pointToTransform(currPoint),\n      transition: `transform ${this.transitionMs}ms ease`,\n    });\n\n    this.timer = window.setTimeout(() => {\n      if (this.current < this.plan.length - 1) {\n        this.nextPoint();\n      } else {\n        this.plan.reverse();\n        this.start();\n      }\n    }, fullDuration);\n  }\n\n  private pointToTransform(pp: PlanPoint): string {\n    const z = 1 + (pp.z * (this.scaleMult - 1));\n    const x = (pp.x - 0.5) * (1 - z) * 100;\n    const y = (pp.y - 0.5) * (1 - z) * 100;\n    return `translate(${x}%, ${y}%) scale(${z})`;\n  }\n};\n\nexport default ContentZoomPan;\n","import React from 'react';\nimport classnames from 'classnames';\n\nimport { createStyles, withStyles, WithStyles, Theme } from '@material-ui/core/styles';\n\nimport ContentData from '../api/ContentData';\nimport ContentType from '../api/ContentType';\nimport ContentZoomPan from '../api/ContentZoomPan';\nimport Size from '../util/Size';\nimport DisplayStyle from '../api/DisplayStyle';\nimport ContentSource from '../api/ContentSource';\n\nconst styles = ({ palette, spacing }: Theme) => createStyles({\n  root: {\n    width: '100%',\n    height: '100%',\n  },\n  content: {\n    width: '100%',\n    height: '100%',\n    objectFit: 'scale-down',\n    pointerEvents: 'none',\n  },\n  contentStretch: {\n    objectFit: 'contain',\n  },\n  contentZoomPan: {\n    objectFit: 'contain',\n  },\n});\n\ninterface Props extends WithStyles<typeof styles> {\n  className?: string;\n  data: ContentData;\n  duration?: number;\n  isActive: boolean;\n  displayStyle?: DisplayStyle;\n  volume?: number;\n  onSourceInvalid?: (source: ContentSource) => void;\n}\nconst ContentRenderer: React.FC<Props> = ({\n  classes,\n  className,\n  data,\n  duration = 0,\n  isActive,\n  displayStyle = DisplayStyle.Standard,\n  volume = 0,\n  onSourceInvalid = () => undefined,\n}) => {\n  const [dataUrl, setDataUrl] = React.useState('');\n  const [error, setError] = React.useState('');\n  const [transform, setTransform] = React.useState({});\n\n  const rootRef = React.useRef<HTMLDivElement>(null);\n\n  React.useEffect(() => {\n    const onLoad = (err: string | undefined, url: string | undefined) => {\n      setDataUrl(url ?? '');\n      setError(err ?? '');\n      if (err) {\n        console.warn(`Unable to load \"${data.contentSource.name}\" as image or video: ${err}`);\n        onSourceInvalid(data.contentSource);\n      }\n    };\n    data.load(onLoad);\n    return () => {\n      data.cancelLoad(onLoad);\n    };\n  }, [data, onSourceInvalid]);\n\n  const contentSize = data.getSize();\n  const contentType = data.getType();\n  const displaySize = new Size(rootRef.current?.clientWidth || 1, rootRef.current?.clientHeight || 1);\n  React.useEffect(() => {\n    const isZoomPan = [DisplayStyle.ZoomPan, DisplayStyle.ZoomPanReturn].includes(displayStyle);\n    if (isActive && isZoomPan && contentType === ContentType.Image) {\n      const zoomer = new ContentZoomPan(\n        new Size(contentSize.width, contentSize.height),\n        new Size(displaySize.width, displaySize.height),\n        duration,\n        setTransform,\n        displayStyle === DisplayStyle.ZoomPanReturn,\n      );\n      zoomer.start();\n      return () => zoomer.stop();\n    }\n  }, [isActive, displayStyle, duration, displaySize.width, displaySize.height, contentSize.width, contentSize.height, contentType]);\n\n  const imgVidClassName = classnames(classes.content, {\n    [classes.contentStretch]: displayStyle === DisplayStyle.Stretch,\n    [classes.contentZoomPan]: [DisplayStyle.ZoomPan, DisplayStyle.ZoomPanReturn].includes(displayStyle),\n  });\n  let content = null;\n  if (error) return content = <span>Error loading {data.contentSource.name}: {error}</span>;\n  else if (!dataUrl) return <span>Loading...</span>;\n  else if (contentType === ContentType.Image) {\n    content = <img className={imgVidClassName} src={dataUrl} alt=\"\" style={transform} />;\n  } else if (contentType === ContentType.Video) {\n    const playPauseOnMount = (vid: HTMLVideoElement | null) => {\n      if (vid && vid.paused && isActive) {\n        vid.play();\n      } else if (vid && !vid.paused && !isActive) {\n        vid.pause();\n      }\n    };\n    content = <video\n      autoPlay={isActive}\n      className={imgVidClassName}\n      loop\n      muted={volume === 0}\n      preload=\"auto\"\n      ref={playPauseOnMount}\n      src={dataUrl}\n      style={transform}\n    />;\n  }\n  return <div className={classes.root} ref={rootRef}>{content}</div>;\n};\n\nexport default withStyles(styles)(ContentRenderer);\n","import React from 'react';\n\nimport { makeStyles } from '@material-ui/core/styles';\nimport CssBaseline from '@material-ui/core/CssBaseline';\n\nconst useStyles = makeStyles(theme => ({\n  '@global': {\n    body: {\n      overflow: 'hidden',\n    },\n  },\n}));\n\nconst AppStyle = () => {\n  useStyles();\n  return <CssBaseline />;\n};\n\nexport default AppStyle;\n","import React from 'react';\n\nimport { PaletteType } from '@material-ui/core';\nimport { createMuiTheme, MuiThemeProvider } from '@material-ui/core/styles';\nimport { teal } from '@material-ui/core/colors';\n\nimport AppStyle from './AppStyle';\nimport SlideshowMain from './SlideShowMain';\n\ndeclare module '@material-ui/core/styles/createMuiTheme' {\n  interface ThemeOptions {\n  }\n  interface Theme {\n  }\n}\n\ndeclare module '@material-ui/core/styles/createPalette' {\n  interface PaletteOptions {\n    controlPanel?: PaletteColorOptions;\n    controlPanelOverlay?: PaletteColorOptions;\n  }\n  interface Palette {\n    controlPanel: PaletteColor;\n    controlPanelOverlay: PaletteColor;\n  }\n}\n\nconst createTheme = (themeType: PaletteType) => createMuiTheme({\n  palette: {\n    primary: { main: teal[500] },\n    background: { default: 'black' },\n    controlPanel: { main: 'rgba(25,25,25,1)' },\n    controlPanelOverlay: { main: 'rgba(25,25,25,0.7)' },\n    type: themeType,\n  },\n});\n\nfunction App({ themeType = 'dark' }: { themeType: PaletteType }) {\n  const theme = createTheme(themeType);\n  return (\n    <MuiThemeProvider theme={theme}>\n      <AppStyle />\n      <SlideshowMain />\n    </MuiThemeProvider>\n  );\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './ui/App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\n// Moved to here: https://create-react-app.dev/docs/making-a-progressive-web-app/\nserviceWorker.unregister();\n","\nenum DisplayStyle {\n  Standard,\n  Stretch,\n  ZoomPan,\n  ZoomPanReturn,\n};\n\nexport default DisplayStyle;\n","import isElectron from '../util/isElectron';\nimport DisplayStyle from './DisplayStyle';\nimport TransitionStyle from './TransitionStyle';\n\nconst settingsKey = 'settings';\n\nenum SettingType {\n  bool,\n  enum,\n  number,\n  string,\n}\n\nenum SettingSection {\n  general = 'General',\n  controlBar = 'Control Bar',\n}\ntype Sectkey = keyof (typeof SettingSection);\nconst reverseSections: Map<SettingSection, Sectkey> = new Map(Object.entries(SettingSection).map(([k,v]) => [v, k as Sectkey]));\n\ninterface Setting {\n  section: SettingSection;\n  menu?: {\n    displayName: string;\n    type: SettingType;\n    options?: string[];\n  }\n  default: any;\n}\n\n// We need this to check the definition types are valid while still retaining\n// \"autocompleteability\" of the keys.\nfunction checkValid<T extends { [key: string]: Setting }>(arg: T): T {\n  return arg;\n}\n\nexport const Settings = checkValid({\n  displayStyle: {\n    section: SettingSection.controlBar,\n    default: DisplayStyle.Standard,\n  },\n  isShuffled: {\n    section: SettingSection.controlBar,\n    default: false,\n  },\n  speed: {\n    section: SettingSection.controlBar,\n    default: 3,\n  },\n  volume: {\n    section: SettingSection.controlBar,\n    default: 0, // Mute by default, but allow user to adjust volume later in control.\n  },\n  transitionStyle: {\n    section: SettingSection.controlBar,\n    default: TransitionStyle.Instant,\n  },\n});\ntype PrefKey = keyof (typeof Settings);\nconst reversePrefs: Map<Setting, PrefKey> = new Map(Object.entries(Settings).map(([k,v]) => [v, k as PrefKey]));\n\nfunction getKeys(pref: Setting | PrefKey): { prefKey: PrefKey, fullKey: string } {\n  const prefKey = typeof pref === 'string' ? pref : reversePrefs.get(pref);\n  if (!prefKey) throw Error(`Couldn't find key for setting ${JSON.stringify(pref)}`);\n  const sectKey = reverseSections.get(Settings[prefKey].section);\n  if (!sectKey) throw Error(`Couldn't find section for setting ${prefKey}}`);\n  return { prefKey, fullKey: `${sectKey}.${prefKey}` };\n}\n\nexport function getSetting(pref: Setting | PrefKey): any {\n  const { prefKey, fullKey } = getKeys(pref);\n  let settings;\n  if (isElectron() && global.electronIpc) {\n    settings = global.electronIpc.getSettings();\n  } else {\n    settings = JSON.parse(localStorage.getItem(settingsKey) || '{}');\n  }\n  return settings[fullKey] || Settings[prefKey].default;\n}\n\nexport function setSetting(pref: Setting | PrefKey, value: any) {\n  const { fullKey } = getKeys(pref);\n  if (isElectron() && global.electronIpc) {\n    const settings = global.electronIpc.getSettings();\n    global.electronIpc.setSettings({ ...settings, [fullKey]: value });\n  } else {\n    const settings = JSON.parse(localStorage.getItem(settingsKey) || '{}');\n    localStorage.setItem(settingsKey, JSON.stringify({ ...settings, [fullKey]: value }));\n  }\n}\n","\nenum TransitionStyle {\n  Fade,\n  Slide,\n  Instant,\n};\n\nexport default TransitionStyle;\n","class Size {\n  readonly width: number;\n  readonly height: number;\n\n  constructor(width: number, height: number) {\n    this.width = width;\n    this.height = height;\n  }\n\n  ratio() {\n    return this.width / this.height;\n  }\n}\n\nexport default Size;\n","\nenum ContentType {\n  Image = 'Image',\n  Video = 'Video',\n};\n\nexport default ContentType;\n","\nconst buildArray = <T>(length: number, fill: (index: number) => T) => {\n  return Array.from({ length }).map((_, i) => fill(i));\n};\n\nexport default buildArray;\n","\nconst isElectron = () => /electron/i.test(navigator.userAgent);\n\nexport default isElectron;\n","import ContentSource from './ContentSource';\n\nclass FileContentSource implements ContentSource {\n  file: File;\n  id: string;\n  name: string;\n\n  constructor(id: string, file: File) {\n    this.id = id;\n    this.name = file.name;\n    this.file = file;\n  }\n  \n  getObjectUrl() {\n    return URL.createObjectURL(this.file);\n  }\n}\n\nexport const getFileEntryContentSource = async (fileEntry: FileEntry): Promise<FileContentSource> => {\n    const file = await new Promise<File>((res, rej) => fileEntry.file(res, e => rej(`Error accessing file ${fileEntry.name}: ${e}`)));\n    return getFileContentSource(file);\n};\n\nexport const getFileContentSource = (file: File): FileContentSource => {\n    return new FileContentSource(`${file.name}:${file.size}`, file);\n};\n","import React from 'react';\nimport classnames from 'classnames';\n\nimport { createStyles, withStyles, WithStyles, Theme } from '@material-ui/core/styles';\n\nimport listFileEntries from '../util/listFileEntries';\nimport promiseAny from '../util/promiseAny';\nimport arrayUnique from '../util/arrayUnique';\n\nimport SlideManager from '../api/SlideManager';\nimport SlideshowState, { saveSlideshowStateToSettings } from '../api/SlideshowState';\nimport ContentData from '../api/ContentData';\nimport { getFileContentSource, getFileEntryContentSource } from '../api/FileContentSource';\nimport ContentSource from '../api/ContentSource';\nimport { getSetting, Settings } from '../api/Settings';\nimport SlideState from '../api/SlideState';\nimport SlideshowTimer from '../api/SlideshowTimer';\nimport { getUrlContentSource } from '../api/UrlContentSource';\n\nimport DragAndDrop from './DragAndDrop';\nimport ControlBar from './ControlBar';\nimport WindowSizeWrapper from './hooks/WindowSizeWrapper';\nimport Slider from './Slider';\nimport ContentRenderer from './ContentRenderer';\nimport isElectron from '../util/isElectron';\nimport TitleBar from './TitleBar';\n\nconst ShowControlsDuration = 4000;\nconst PreloadCount = 1;\nconst CacheSize = PreloadCount * 2 + 3;\n\n\nconst titlebarHeight = 30;\nconst controlsHeight = 60;\n\nconst styles = ({ palette, spacing }: Theme) => createStyles({\n  titlebar: {\n    height: titlebarHeight,\n    width: '100%',\n    backgroundColor: palette.controlPanel.main,\n    zIndex: 1000,\n  },\n  titlebarHideable: {\n    backgroundColor: palette.controlPanelOverlay.main,\n    position: 'absolute',\n    top: -titlebarHeight,\n    transitionProperty: 'top',\n    transitionDuration: '1.0s',\n  },\n  titlebarHideableShow: {\n    bottom: 'unset',\n    top: 0,\n    transitionDuration: '0.1s',\n  },\n  slideshow: {\n    backgroundColor: 'black',\n    display: 'flex',\n    flexFlow: 'column',\n    overflow: 'hidden',\n  },\n  mainArea: {\n    width: '100%',\n    height: '100%',\n    flexGrow: 1,\n  },\n  dragDrop: {\n    width: '100%',\n    height: '100%',\n  },\n  controls: {\n    width: '100%',\n    height: controlsHeight,\n    flexGrow: 0,\n    flexShrink: 0,\n    backgroundColor: palette.controlPanel.main,\n    zIndex: 1000,\n  },\n  controlsHideable: {\n    backgroundColor: palette.controlPanelOverlay.main,\n    position: 'absolute',\n    bottom: -controlsHeight,\n    transitionProperty: 'bottom',\n    transitionDuration: '1.0s',\n  },\n  controlsHideableShow: {\n    top: 'unset',\n    bottom: 0,\n    transitionDuration: '0.1s',\n  },\n  hideMouse: {\n    cursor: 'none',\n  },\n});\n\ninterface Props extends WithStyles<typeof styles> {}\ninterface State {\n  ssController: SlideManager | undefined;\n  ssState: SlideshowState;\n  data: ContentData | undefined;\n  showControls: boolean;\n  slideIndex: number;\n}\n\nclass SlideshowMain extends React.Component<Props, State> {\n  rootRef: React.RefObject<HTMLDivElement>;\n  showControlsTimeout: NodeJS.Timeout | undefined;\n  slideshowTimer: SlideshowTimer;\n\n  constructor(props: Props) {\n    super(props);\n    this.state = {\n      ssController: undefined,\n      ssState: {\n        displayStyle: getSetting(Settings.displayStyle),\n        isBorderless: false,\n        isFullscreen: false,\n        isPlaying: false,\n        isShuffled: getSetting(Settings.isShuffled),\n        speed: getSetting(Settings.speed),\n        volume: getSetting(Settings.volume),\n        transitionStyle: getSetting(Settings.transitionStyle),\n      },\n      data: undefined,\n      showControls: false,\n      slideIndex: 0,\n    };\n    this.slideshowTimer = new SlideshowTimer();\n    this.slideshowTimer.onNext = this.handleNext;\n    this.rootRef = React.createRef<HTMLDivElement>();\n  }\n\n  componentDidMount() {\n    document.addEventListener('keyup', this.handleKeyUp);\n    document.addEventListener('fullscreenchange', this.handleFullscreenChange);\n  }\n\n  componentWillUnmount() {\n    document.removeEventListener('keyup', this.handleKeyUp);\n    document.removeEventListener('fullscreenchange', this.handleFullscreenChange);\n    this.slideshowTimer.stop();\n  }\n\n  updateSsState(newSsState: Partial<SlideshowState>) {\n    const { ssState } = this.state;\n    this.setState({ ssState: { ...ssState, ...newSsState }});\n    saveSlideshowStateToSettings(newSsState);\n  }\n\n  enterFullscreen = () => {\n    this.rootRef.current?.requestFullscreen();\n    this.showControls();\n  }\n\n  exitFullscreen = () => {\n    if (document.fullscreenElement) {\n      document.exitFullscreen();\n    }\n  }\n\n  handlePause = () => {\n    this.slideshowTimer.stop();\n    this.updateSsState({ isPlaying: false });\n    this.showControls();\n  }\n\n  handlePlay = () => {\n    this.slideshowTimer.start();\n    this.updateSsState({ isPlaying: true });\n    this.showControls();\n  }\n\n  handleShuffleChange = (shuffle: boolean) => {\n    const { ssController, slideIndex } = this.state;\n    const startAtSid = ssController?.getDataForIndex(slideIndex).contentSource.id;\n    const startAtIndex = slideIndex + CacheSize;\n    if (shuffle) {\n      ssController?.shuffle({ startAtSid, startAtIndex });\n    } else {\n      ssController?.unshuffle({ startAtSid, startAtIndex });\n    }\n    this.updateSsState({ isShuffled: shuffle });\n    this.showControls();\n    this.setSlideIndex(startAtIndex);\n  }\n\n  handleSpeedChange = (speed: number) => {\n    this.slideshowTimer.setSpeed(speed);\n    this.updateSsState({ speed });\n    this.showControls();\n  }\n\n  handlePlainSssChange = (state: Partial<SlideshowState>) => {\n    this.updateSsState(state);\n    this.showControls();\n  }\n\n  showControls = () => {\n    const { showControls } = this.state;\n    if (this.showControlsTimeout) clearTimeout(this.showControlsTimeout);\n    if (this.constrolsHideable()) {\n      this.showControlsTimeout = setTimeout(this.handleShowControlsTimeout, ShowControlsDuration);\n      if (!showControls) {\n        this.setState({ showControls: true });\n      }\n    }\n  }\n\n  handleFullscreenChange = () => {\n    this.updateSsState({ isFullscreen: !!document.fullscreenElement });\n  }\n\n  handleDrop = async (items: DataTransferItemList) => {\n    const fileItems = Array.from(items).filter(i => i.kind === 'file');\n    const files = await listFileEntries(...fileItems.map(i => i.webkitGetAsEntry()));\n    const { values, reasons } = await promiseAny(files.map(f => getFileEntryContentSource(f)));\n    reasons.forEach(r => console.error(`Error adding file: ${r}`));\n    this.addNewSources(values);\n  }\n\n  handleFilesAdded = (files: File[]) => {\n    this.addNewSources(files.map(f => getFileContentSource(f)));\n  }\n\n  handleUrlsAdded = async (urls: string[]) => {\n    // const types = await Promise.all(urls.map(fetchUrlMimeType));\n    // const newSources: ContentSource[] = [];\n    // types.forEach((type, i) => {\n    //   if (type.startsWith('image/')) {\n    //     newSources.push(getUrlContentSource(urls[i]));\n    //   } else if (type === 'text/plain') {\n    //     console.log('Loading compilation files not yet supported...');\n    //   } else {\n    //     console.warn(`Unknown content type of URL ${urls[i]}: ${type}`);\n    //   }\n    // });\n    // this.addNewSources(newSources);\n    this.addNewSources(urls.map(getUrlContentSource));\n  }\n\n  handleKeyUp = (e: KeyboardEvent) => {\n    const { ssState } = this.state;\n    let handled = true;\n    if (e.key === 'ArrowLeft') this.handlePrevious();\n    else if (e.key === ' ' && !ssState.isPlaying) this.handlePlay();\n    else if (e.key === ' ' && ssState.isPlaying) this.handlePause();\n    else if (e.key === 'ArrowRight') this.handleNext();\n    else if (e.key === 'Enter' && !ssState.isFullscreen) this.enterFullscreen();\n    else if (e.key === 'Enter' && ssState.isFullscreen) this.exitFullscreen();\n    else if (e.key === '\\\\') this.handlePlainSssChange({ isBorderless: !ssState.isBorderless });\n    else if (e.key === 'F11') this.handlePlainSssChange({ isBorderless: !ssState.isBorderless });\n    else if (e.key === 'f' && !ssState.isFullscreen) this.enterFullscreen();\n    else if (e.key === 'f' && ssState.isFullscreen) this.exitFullscreen();\n    else if (e.key === 'Escape') {\n      this.exitFullscreen();\n      this.handlePlainSssChange({ isBorderless: false });\n    }\n    else if (e.key === 'F12' && isElectron()) global.electronIpc?.openDevTools();\n    else {\n      handled = false;\n      // console.log('Unknown key pressed:', e);\n    }\n    if (handled) {\n      e.preventDefault();\n      e.stopPropagation();\n    }\n  };\n\n  handleShowControlsTimeout = () => {\n    this.setState({ showControls: false });\n  }\n\n  handleNext = () => {\n    this.setSlideIndex(this.state.slideIndex + 1);\n  }\n\n  handlePrevious = () => {\n    this.setSlideIndex(this.state.slideIndex - 1);\n  }\n\n  addNewSources(sources: ContentSource[]) {\n    const { ssController, ssState, slideIndex } = this.state;\n    this.slideshowTimer.stop();\n    const startAtSid = ssController?.getDataForIndex(slideIndex).contentSource.id;\n    const startAtIndex = slideIndex + CacheSize;\n    ssController?.cleanup();\n    const newSources = arrayUnique([...(ssController?.sources ?? []), ...sources], s => s.id);\n    const newSsc = new SlideManager(newSources, { cacheSize: CacheSize, startAtSid, startAtIndex });\n    this.slideshowTimer.getData = index => newSsc.getDataForIndex(index);\n    if (ssState.isShuffled) {\n      newSsc.shuffle({ startAtSid, startAtIndex });\n    }\n    if (ssState.isPlaying) {\n      this.slideshowTimer.start();\n    }\n    this.setState({\n      data: undefined,\n      ssController: newSsc,\n    });\n    this.setSlideIndex(startAtIndex);\n  }\n\n  setSlideIndex(index: number) {\n    this.setState({ slideIndex: index });\n    this.slideshowTimer.setIndex(index);\n  }\n\n  renderSlideContent = ({ index, isActive }: SlideState) => {\n    const { ssController, ssState } = this.state;\n    return ssController && <ContentRenderer\n      data={ssController.getDataForIndex(index)}\n      duration={isActive ? this.slideshowTimer.slideDuration() : undefined}\n      isActive={isActive}\n      displayStyle={ssState.displayStyle}\n      volume={ssState.volume}\n      onSourceInvalid={(source) => ssController.removeSource(source)}\n    />\n  }\n\n  constrolsHideable() {\n    const { ssState } = this.state;\n    return ssState.isFullscreen || ssState.isBorderless;\n  }\n\n  render() {\n    const { classes } = this.props;\n    const { ssState, showControls, slideIndex, ssController } = this.state;\n    return (\n      <WindowSizeWrapper>\n        {(size) =>(\n          <div\n            className={classnames(classes.slideshow, {\n              [classes.hideMouse]: this.constrolsHideable() && !showControls,\n            })}\n            onMouseMove={this.showControls}\n            onMouseDown={this.showControls}\n            ref={this.rootRef}\n            style={{ width: size.width, height: size.height }}\n          >\n            {isElectron() && <TitleBar\n              className={classnames(classes.titlebar, {\n                [classes.titlebarHideable]: this.constrolsHideable(),\n                [classes.titlebarHideableShow]: this.constrolsHideable() && showControls,\n              })}\n              slideTitle={ssController?.getDataForIndex(slideIndex).contentSource.name}\n            />}\n            <div\n              className={classes.mainArea}\n              onDoubleClick={() => {\n                if (!document.fullscreenElement) this.enterFullscreen();\n                if (!!document.fullscreenElement) this.exitFullscreen();\n              }}\n            >\n              <DragAndDrop className={classes.dragDrop} onDrop={this.handleDrop}>\n                <Slider\n                  onNext={this.handleNext}\n                  onBack={this.handlePrevious}\n                  slideContentRenderer={this.renderSlideContent}\n                  slideIndex={slideIndex}\n                  preloadCount={PreloadCount}\n                  transitionStyle={ssState.transitionStyle}\n                />\n              </DragAndDrop>\n            </div>\n            <ControlBar\n              className={classnames(classes.controls, {\n                [classes.controlsHideable]: this.constrolsHideable(),\n                [classes.controlsHideableShow]: this.constrolsHideable() && showControls,\n              })}\n              screenWidth={size.width}\n              state={ssState}\n              onNext={this.handleNext}\n              onPlay={this.handlePlay}\n              onPause={this.handlePause}\n              onBack={this.handlePrevious}\n              onEnterFullscreen={this.enterFullscreen}\n              onExitFullscreen={this.exitFullscreen}\n              onDisplayStyleChange={(displayStyle) => this.handlePlainSssChange({ displayStyle })}\n              onShuffleChange={this.handleShuffleChange}\n              onSpeedChange={this.handleSpeedChange}\n              onTransitionStyleChange={(transitionStyle) => this.handlePlainSssChange({ transitionStyle })}\n              onVolumeChange={(volume) => this.handlePlainSssChange({ volume })}\n              onFilesAdded={this.handleFilesAdded}\n              onUrlsAdded={this.handleUrlsAdded}\n            />\n          </div>\n        )}\n      </WindowSizeWrapper>\n    );\n  }\n}\n\nexport default withStyles(styles)(SlideshowMain);\n","\nconst listFileEntries = async (...fileEntries: Entry[]): Promise<FileEntry[]> => {\n  return (await Promise.all(fileEntries.map((fileEntry): Promise<any> | any => {\n    if (fileEntry.isFile) {\n      return fileEntry;\n    } else if (fileEntry.isDirectory) {\n      return new Promise<FileEntry[]>((res, rej) => {\n        (fileEntry as DirectoryEntry).createReader().readEntries(\n          (entries: any[]) => res(listFileEntries(...entries)),\n          (error: any) => rej(error),\n        );\n      });\n    }\n    return [];\n  }))).flat();\n};\n\nexport default listFileEntries;\n","type PromiseAnyResult<T> = {\n  /** The values of the fulfilled promises */\n  values: T[];\n  /** The reasons of the rejected promises */\n  reasons: any[];\n}\n\nasync function promiseAny<T>(promises: Promise<T>[]): Promise<PromiseAnyResult<T>> {\n  const results = await Promise.allSettled(promises);\n  const values: T[] = [];\n  const reasons: any[] = [];\n  results.forEach((r) => {\n    if (r.status === 'fulfilled') {\n      values.push(r.value);\n    } else {\n      reasons.push(r.reason);\n    }\n  });\n  return { values, reasons };\n}\n\nexport default promiseAny;\n","\n/**\n * Uniqify a given array.\n * @param {*[]} arr The array to uniqify.\n * @param {function} [keyFunc] The function to determine the\n *  unique \"key\" for each item.\n * @returns A copy of the array, but without duplicates.\n */\nconst arrayUnique = <T>(arr: T[], keyFunc?: (item: T) => any) =>\n  Array.from(arr.reduce((result, item) => {\n    const key = (keyFunc && keyFunc(item)) || item;\n    result.set(key, item);\n    return result;\n  }, new Map<any, T>()).values());\n\nexport default arrayUnique;\n","import DisplayStyle from './DisplayStyle';\nimport { setSetting, Settings } from './Settings';\nimport TransitionStyle from './TransitionStyle';\n\ntype SlideshowState = {\n  displayStyle: DisplayStyle;\n  isBorderless: boolean;\n  isFullscreen: boolean;\n  isPlaying: boolean;\n  isShuffled: boolean;\n  speed: number;\n  volume: number;\n  transitionStyle: TransitionStyle;\n};\n\nexport const saveSlideshowStateToSettings = (state: Partial<SlideshowState>) => {\n  if (state.displayStyle !== undefined) setSetting(Settings.displayStyle, state.displayStyle);\n  if (state.isShuffled !== undefined) setSetting(Settings.isShuffled, state.isShuffled);\n  if (state.speed !== undefined) setSetting(Settings.speed, state.speed);\n  if (state.transitionStyle !== undefined) setSetting(Settings.transitionStyle, state.transitionStyle);\n  if (state.volume !== undefined) setSetting(Settings.volume, state.volume);\n};\n\nexport default SlideshowState;\n","import ContentData from './ContentData';\n\nconst SpeedDelay = [35000, 25000, 18000, 10000, 5000];\n\nclass SlideshowTimer {\n  onNext: () => void = () => {};\n  getData: (index: number) => (ContentData | undefined) = () => undefined;\n  private speed: number;\n\n  private index: number;\n  private timeout?: number;\n  private startedAt: Date;\n\n  private data?: ContentData;\n\n  constructor(speed = 3) {\n    this.index = 0;\n    this.speed = speed;\n    this.startedAt = new Date();\n  }\n\n  isPlaying() {\n    return !!this.timeout;\n  }\n\n  start() {\n    this.stop();\n    this.startedAt = new Date();\n    this.data = this.getData(this.index);\n    if (!this.data?.isLoaded()) {\n      this.data?.load(this.handleDataLoaded);\n    }\n    this.updateTimer();\n  }\n  \n  stop() {\n    clearTimeout(this.timeout);\n    this.timeout = undefined;\n    this.data?.cancelLoad(this.handleDataLoaded);\n  }\n\n  setIndex(index: number) {\n    if (index !== this.index) {\n      this.index = index;\n      if (this.isPlaying()) {\n        this.start();\n      }\n    }\n  }\n\n  setSpeed(speed: number) {\n    this.speed = speed;\n    if (this.isPlaying()) {\n      this.updateTimer();\n    }\n  }\n\n  slideDuration(): number {\n    const stdDuration = SpeedDelay[this.speed - 1];\n    const vidDuration = (this.data?.getDuration() ?? 0) * 1000;\n    return Math.max(stdDuration, vidDuration);\n  }\n\n  private handleDataLoaded = () => {\n    this.updateTimer();\n  }\n\n  private updateTimer() {\n    clearTimeout(this.timeout);\n    const delay = this.calculateRemainingDuration();\n    this.timeout = window.setTimeout(this.onNext, delay);\n  }\n\n  private calculateRemainingDuration(): number {\n    return this.slideDuration() - (+new Date() - +this.startedAt);\n  }\n\n}\n\nexport default SlideshowTimer;\n","import ContentSource from './ContentSource';\n\nclass UrlContentSource implements ContentSource {\n  url: string;\n  id: string;\n  name: string;\n\n  constructor(url: string) {\n    this.id = url;\n    this.name = url;\n    this.url = url;\n  }\n  \n  getObjectUrl() {\n    return this.url;\n  }\n}\n\nexport const getUrlContentSource = (url: string): UrlContentSource => {\n    return new UrlContentSource(url);\n};\n","import React, { Component } from 'react';\n\nimport { createStyles, withStyles, WithStyles, Theme } from '@material-ui/core/styles';\n\nconst styles = ({ palette, spacing }: Theme) => createStyles({\n  overlay: {\n    border: 'dashed grey 4px',\n    backgroundColor: 'rgba(255,255,255,.8)',\n    position: 'absolute',\n    top: 0,\n    bottom: 0,\n    left: 0, \n    right: 0,\n    zIndex: 9999\n  },\n  overlayMessage: {\n    position: 'absolute',\n    top: '50%',\n    right: 0,\n    left: 0,\n    textAlign: 'center',\n    color: 'grey',\n    fontSize: 36\n  },\n});\n\ninterface Props extends WithStyles<typeof styles> {\n  className?: string;\n  onDrop: (items: DataTransferItemList) => void;\n};\ninterface State {\n  dragging: boolean;\n};\nclass DragAndDrop extends Component<Props, State> {\n  dropRef: React.RefObject<HTMLDivElement> = React.createRef();\n  dragCounter = 0;\n  state: State = {\n    dragging: false,\n  };\n  \n  handleDrag = (e: DragEvent) => {\n    e.preventDefault();\n    e.stopPropagation();\n  };\n\n  handleDragIn = (e: DragEvent) => {\n    e.preventDefault();\n    e.stopPropagation();\n    this.dragCounter++;\n    if (e.dataTransfer?.items?.length) {\n      this.setState({dragging: true})\n    }\n  };\n\n  handleDragOut = (e: DragEvent) => {\n    e.preventDefault();\n    e.stopPropagation();\n    this.dragCounter--;\n    if (this.dragCounter <= 0) {\n      this.setState({ dragging: false });\n    }\n  };\n\n  handleDrop = (e: DragEvent) => {\n    e.preventDefault();\n    e.stopPropagation();\n    this.setState({ dragging: false });\n    if (e.dataTransfer?.items?.length) {\n      this.props.onDrop(e.dataTransfer.items);\n    }\n    this.dragCounter = 0;\n  };\n  \n  componentDidMount() {\n    this.dragCounter = 0;\n    let div = this.dropRef.current;\n    if (div) {\n      div.addEventListener('dragenter', this.handleDragIn)\n      div.addEventListener('dragleave', this.handleDragOut)\n      div.addEventListener('dragover', this.handleDrag)\n      div.addEventListener('drop', this.handleDrop)\n    }\n  }\n  \n  componentWillUnmount() {\n    let div = this.dropRef.current;\n    if (div) {\n      div.removeEventListener('dragenter', this.handleDragIn)\n      div.removeEventListener('dragleave', this.handleDragOut)\n      div.removeEventListener('dragover', this.handleDrag)\n      div.removeEventListener('drop', this.handleDrop)\n    }\n  }\n\n  render() {\n    const { classes, className } = this.props;\n    return (\n      <div className={className} ref={this.dropRef}>\n        {this.state.dragging && (\n          <div className={classes.overlay}>\n            <div className={classes.overlayMessage}>\n              <div>drop here :)</div>\n            </div>\n          </div>\n        )}\n        {this.props.children}\n      </div>\n    )\n  }\n}\n\nexport default withStyles(styles)(DragAndDrop);\n"],"sourceRoot":""}